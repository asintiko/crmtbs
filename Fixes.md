Task List: Bug Fixes & Logic Refinement
В ходе ревью текущей сборки были обнаружены ошибки в типах, логике долгов и расчетах остатков. Необходимо внести следующие исправления.

1. Исправление TypeScript ошибки (Critical)
Файл: src/shared/ipc.ts (lines 11-19)
Проблема: Интерфейс InventoryAPI использует UpdateProductPayload, но он не импортирован. Сборка падает при строгом режиме.
Задача:

Добавить корректный импорт UpdateProductPayload (обычно из src/shared/types или аналогичного файла определений).
2. Логика работы с Архивными товарами
Файлы: src/lib/search.ts (lines 3-28), src/components/OperationForm.tsx (lines 36-69)
Проблема: В поиске (при создании операции) выдаются товары, у которых стоит флаг isArchived = true. Это позволяет случайно провести операцию по выведенному из оборота товару.
Задача:

Изменить SQL-запрос или фильтрацию в search.ts: исключить из выдачи товары, где is_archived = 1.
Важно: В таблице "Склад" (Stock) эти товары должны остаться видимыми (возможно, с пометкой "Архив"), если по ним есть остатки. Скрытие касается только Input-поиска в форме операций.
3. Валидация операций "Долг" (Debt Logic)
Файлы: electron/database.ts (269-275, 427-432), src/components/OperationForm.tsx (lines 93-106)
Проблема: Можно создать операцию "Погашение долга" на сумму, превышающую реальный долг, или для клиента без долгов. Это приводит к отрицательным значениям.

Задача (Backend/Database):

Перед транзакцией типа DEBT_PAYMENT выполнить проверку:
SELECT debt_quantity FROM debts WHERE client_id = ? AND product_id = ?
Если payment_amount > current_debt, выбросить ошибку: "Сумма погашения превышает остаток долга".
Задача (Frontend/UI):

В форме операции, если выбран тип "Погашение долга":
После выбора Клиента и Товара подгружать текущий долг.
Установить атрибут max для поля количества равным текущему долгу.
Отображать подсказку: "Текущий долг: X шт.".
4. Исправление формулы расчета "Всего" (Stock Calculation)
Файл: src/pages/Stock.tsx (lines 70-123)
Проблема: Сейчас колонка "Всего" (Total) считается как OnHand + Debt. Это путает, так как при отгрузке в долг число не меняется.

Задача:
Изменить логику отображения столбцов в таблице Склад. Должно быть так:

Всего (Physically On Hand):
Формула: Sum(Supply) + Sum(Returns) - Sum(Sales) - Sum(DebtShipment).
Суть: Это физическое наличие товара на полке. Отгрузка в долг — это уход товара со склада.
Доступно (Available):
Формула: Col_Total - Booked.
В долгу (On Credit):
Формула: Отдельный счетчик (сколько отгрузили в долг минус сколько погасили/вернули).
Итог: При операции "Отгрузка в долг" (Shipment on Debt):

Колонка "Всего" -> Уменьшается.
Колонка "В долгу" -> Увеличивается.